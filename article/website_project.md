---
title: 计算机网络
date: 2020-12-22 20:22:11
categories:
- study
---

## 进制转换

十进制：89D；
八进制：89O；
十六进制：89H；
>二进制数1101.01转化成十进制
`1101.01（2）=1*2^0+0*2^1+1*2^2+1*2^3 +0*2^(-1)+1*2^(-2)=1+0+4+8+0+0.25=13.25（10）`

- 十进制整数转换为二进制整数采用"除2取余，逆序排列"法。具体做法是：用2整除十进制整数，可以得到一个商和余数；再用2去除商，又会得到一个商和余数，如此进行，直到商为小于1时为止，然后把先得到的余数作为二进制数的低位有效位，后得到的余数作为二进制数的高位有效位，依次排列起来。


- 十进制小数转换成二进制小数采用"乘2取整，顺序排列"法。具体做法是：用2乘十进制小数，可以得到积，将积的整数部分取出，再用2乘余下的小数部分，又得到一个积，再将积的整数部分取出，如此进行，直到积中的小数部分为零，此时0或1为二进制的最后一位。或者达到所要求的精度为止。

- 整数二进制转八进制：从右往左每三位二进制转1位八进制，不足三位在左边补零；反之八进制转二进制，每一位八进制转换为三位二进制

- 整数二进制转十六进制:从右往左每四位二进制转1位十六进制，不足四位在左边补零；反之十六进制转二进制，每一位十六进制转换为四位二进制
>[0~9,a-f]

最高位为符号位：1表示负数，0表示正数  
反码：正数原码反码一样，负数符号位不变，其他取反  
补码：正数原码补码一样，负数在反码的基础上加1，由补码求原码则是先取反再加1  
>计算机中一般采用补码进行存储，因为补码和移码的0是唯一，补码可以直接带符号运算而不出现错误

取值范围：
原码：-[2^(n-1)-1]~2^(n-1)-1
反码：-[2^(n-1)-1]~2^(n-1)-1
补码：-2^(n-1)~2^(n-1)-1

### 逻辑运算

- 或：有1则为1
- 与：全1才为1
- 非：取反
- 异或：不相同才为1

### 计算机结构
- 总线：数据总线，地址总线，控制总线；
- 主机：
   1. 主存储器
   2.cpu
      * 运算器
         1. 算术逻辑单元ALU
         2. 累加寄存器AC:暂存计算结果
         3. 数据缓冲寄存器
         4. 状态条件寄存器
      * 控制器
         1. 程序计数器PC:储存指令地址
         2. 指令寄存器IR
         3. 指令译码器
         4. 时序部件

寻址方式：
一条指令包括操作码和地址码
1. 立即寻址
2. 内存寻址
   * 变址寻址
   * 直接寻址
   * 间接寻址
3. 寄存器寻址与寄存器间接寻址

CISC(复杂)与RISC(精简)
* CISC:
* RISC:统一指令编码、泛用的寄存器、单纯的寻址方式、硬件中支持少数资料类型。

流水线：

取址-》分析-》执行
流水线执行时间计算公式：`(t1+t2+t3)+(n-1)t1`
(t1+t2+t3)为一条指令顺序执行时间即取址、分析、执行的时间之和。t1为三个步骤中执行时间最长的一段
吞吐率：指令条数/流水线执行时间
加速比：不使用流水线的时间/使用流水线的执行时间

### 存储容量单位

主存(内存):RAM随机存储器，掉电丢失；ROM只读存储器，掉电不丢失；
缓存cache：缓和寄存器与内存间的速率矛盾；
>Cache的访问命中率为h，Cache访问周期为t1，主存器访问时间为t2；整个系统的平均访存时间为`h* t1+(1-h)*t2`

地址范围：末地址-首地址+1
>注意：二进制10-1=1

位：bit
字节：1B=8bit
字：通常为字节的整数倍

1K=2^10b
1M=2^10K
1G=2^10M


磁盘：
RAID技术:
1. RAID0:将所有硬盘构成一个磁盘阵列。写入速度快，不具备备份和容错能力；可靠性最差;利用率为100%
2. RAID1:磁盘镜像技术，将一个硬盘的内容同步备份到另一个硬盘；具备容错和备份能力；效率不高，可靠性好；利用率为50%
3. RAID3:奇偶校验盘的分段技术；容错性好，可靠性高；单块硬盘失效时会出现I/O瓶颈。有一块磁盘用于存放校验数据所以利用率=（n-1）/n
4. RAID5:分布式奇偶校验技术，校验值分布在各盘的不同位置；性能比RAID3好;利用率一样
5. RAID6:带有两个独立分布式校验方案的独立数据磁盘；能实现两个磁盘掉线容错；磁盘利用率（n-2）/n

进程管理
等待，就绪，运行

死锁：一个进程在等待一个不可能发生的事就会出现死锁
解决死锁：
1. 预防死锁
2. 死锁避免
   * 银行家算法
3. 死锁检测
4. 死锁解除

pv操作：
解决进程互斥同步问题
P操作：使s=s-1若s>=0则进程继续执行，否则进入等待队列；
V操作：使s=s+1若s<=0则唤醒等待队列中的一个进程

软件开发模型：
瀑布模型
v模型
喷泉模型
螺旋模型
### 网络按分布范围分类

局域网(误码率最小)，城域网，广域网

### 网络按拓扑结构分类

总线型、星型、环型、树形、网状型、混合型

### OSI七层模型


|osi层次|封装单位|地址标识|功能|
|-:|:-:|:-:|:-:|
|物理层|比特流|BIt|定义物理设备接口链路标准|
|数据链路层|数据帧|MAC地址|比特流封装成帧，帧同步，差错、流量控制|
|网络层|数据包，分组|IP地址|路径选择，网络寻址|
|传输层|数据段|端口号|端与端可靠的数据传输，分段与重组|
|会话层|应用进程|进程号|会话的连接与释放,同步|
|表示层|应用进程|进程号|数据加密，数据压缩|
|应用层|应用进程|进程号|用户应用程序的协议|

OSI网络管理标准中的5大功能：配置管理、故障管理、性能管理、安全管理、计费管理；
### tcp/ip四层模型

网络接口层(物理层和数据链路层)，网络层，传输层，应用层

**数据的封装：**

||||
|-|-|-|
|上层数据|应用层|HTTP FTP TFTP SMTP SNMP DNS|
|tcp头部+上层数据|传输层|TPC UDP|
|ip头部+tcp头部+上层数据|网络层|ICMP iGMP IP ARP RARP|
|MAC头部+ip头部+tcp头部+上层数据|数据链路层|由底层网络定义协议|
|二进制数据|物理层|由底层网络定义的协议|


### 时延

发送时延=数据帧长度/信道带宽
传播时延=信道长度/电磁波在信道上的传播速率；



### 传输介质
1. 双绞线：屏蔽双绞线（stp）非屏蔽双绞线（utp）；  
双绞线线序：T568A,T6568B;  
双绞线两端使用相同标准称为直通线，否则称为交叉线； 

|设备互联|线缆种类|
|-|-|
|计算机--计算机|交叉线|
|计算机--交换机|直通线|
|计算机--路由器|交叉线|
|交换机--交换机|交叉线|
|交换机--路由器|直通线|
|路由器--路由器|交叉线|

2. 同轴电缆

3. 光纤

单模单纤: 激光二极管LED做光源;传播距离远，数据传输速率高，信号衰减小；造价高  
多模光纤：发光二极管LED做为光源;反之  

### 局域网技术

#### 信道

噪声影响：香浓理论：`C=Wlog(2)(1+S/N)`;W：带宽；S:信号平均功率；N:噪声平均功率；由于信噪比S/N的比值通常太大，因此通常用分贝db来表示db=10log(s/n)


调制与解调

||模拟信道|数字信道|
|-|-|-|
|模拟数据|调幅AM、调频FM、调相PM、正交调相QAM|采样、量化、编码|
|数字数据|调制：ASK(码元种类：2),FSK(码元种类：2),PSK(码元种类：2),DPSK(码元种类：4)|基本编码，应用型编码|

>异步通信中，每个字符包含一位起始位、7位数据位、1位奇偶位、一位终止位，每秒传送100个字符，采用DPSK调制，则码元速率位1000波特，有效数据速率为700bps

|标准|频段|技术|速率|
|-|-|-|-|
|802.11|2.4GHz的ISM频段|扩频通信技术|1mbps|
|802.11b|2.4GHz的ISM频段|CCK技术|11mbps|
|802.11a|5GHz的U-NII频段|OFDM调制技术|54mbps|
|802.11g|2.4GHz的ISM频段|OFDM调制技术|54mbps|
|802.11n|2.4GHz和5GHz|MIMO,OFDM|600mbps|


应用型编码：
曼切斯特编码（常用于10M以太网）和差分曼特斯特编码（常用于令牌环网），编码效率只有50%

#### 差错控制：
任意两个码字之间最少变化的二进制位数称为该数据编码的最小码距

在一个码组内为了检测e个误码，最小码距应满足：`d>=e+1`;
在一个码组内为了纠正t个误码，则最小码距应满足：`d>=2t+1`

奇偶校验：
检错码=信息字段+校检字段；

海明校验：
海明码特点：`m+k+1<=2^k`

CRC校验



### 局域网设备

1. 集线器：物理层
2. 网桥：数据链路层；生成树网桥、源路由网桥；
3. 交换机：数据链路层；
4. 路由器：网络层

>交换机根据以太网帧中的目的地址智能转发数据，只能分割冲突域,交换机分割冲突域，实现全双工通信，不使用CSMA/CD协议。交换机级联可在不同厂家的设备间使用，而堆叠只能在通厂家间的设备进行；路由器能分割冲突域和广播域，集线器啥都不能；

交换机与路由器相关参数计算：
背板带宽=端口数*相应端口速率*2（全双工模式）  
包转发率=千兆端口数量*1.488Mpps+百兆端口数量*0.1488MPPS+其余端口数*相应速率

### 无线局域网

|种类|标准|应用|
|-|-|-|
|无线个人网WPAN|IEEE802.15|蓝牙|
|无线局域网WLAN|IEEE802.11|企业|
|无线城/广域网WMAN|IEEE802.20&&蜂窝通信|访问internet|

加密
WEP：对称加密算法；
WPA2:AES加密算法；


### 流量和差错控制

停等协议
滑动窗口协议
停等ARQ协议
选择重发ARQ：其最大值就是最小帧编号总数的一半即`W发=W收<=2^(k-1)`
后退N帧ARQ:限制发送窗口的大小为`W<=2^k-1`

### 以太网标准

1. 以太网：早期的局域网标准802.3，速率10Mbps。最小帧长64B，最大帧长1518B.10Basc-T：无屏蔽双绞线，曼切斯特编码，半双工模式

2. 快速以太网：802.3u标准，速率100Mbps，最小帧长64B，最大帧长1518B.100Basc_TX:
2对5类非屏蔽双绞线，一对发，一对收，4B/5B与MLT-3编码，全双工模式。
100Basc-T4：4对3类非屏蔽双绞线，最大长度100m，三对数据传输，一对冲突检测；8B/6T编码；半双工模式。
100Basc-FX：一对光纤，最大长度45m，一发一收，4B/5B编码；全双工

3. 千兆以太网：802.3z标准，速率1000Mbps，最小帧长512B,最大帧长1518B。
1000 Basc-1.X：全双工，半双工，多模光纤；8B/10B编码，
1000 Basc-T:非屏蔽双绞线，PAM5编码。

4. 万兆以太网：全双工；802.3ac标准，最小帧长64B，最大1518B。64B/66B编码；光纤；

CSMA/CD协议：
最短帧长计算：`传播时延>=2*传播时延`

Mac地址： 48位；前24位为供应商标志；后为网卡的唯一编码；
mac帧：组成6位目的地址，6位源地址，2位类型，数据46位~1500位，4位FCS
 
### vlan

基于802.1Q标准，每个交换机所有端口都处于广播域，交换机所有端口默认属于vlan1。VLAN:把同一物理局域网内的不同用户，在逻辑上划分成不同的广播域。vlan的取值范围为0-4095；

access接口为数据打上vlan id，用于交换机连接终端设备，只允许一个vlan帧通过。
trunk链路可以放行多个vlan的流量，用于交换机之间连接。允许多个vlan通过，除缺省vlan外其它vlan都带有标签通过trunk端口。
hybrid端口：允许一个或多个vlan的帧通过，可以选择是否带标签。

- vlan注册协议：GVRP协议
   1. Normal模式：允许该端口动态注册或注销Vlan，传播动态或静态vlan信息；
   2. Fixed模式：禁止该端口动态注册或注销Vlan，只传播静态vlan信息；
   3. Forbidden模式：禁止该端口动态注册或注销Vlan，除vlan1外，不传播任何vlan信息；

- 生成树协议：STP
删除交换机之间的网络环路，逻辑上断开环路，防止广播风暴的产生,增加了带宽，提高了网络的可靠性。

   1. 选择根网桥：交换机之间选择网桥ID值最小的。网桥ID组成：网桥优先值2字节（取值范围0~65535，默认32768，越小优先级越高）+网桥mac地址6字节；
   2. 选择根端口：本端口到根网桥路径成本最低，网桥ID最小，端口ID最小。端口ID=端口优先级+端口编号
   3. 选择指定端口：端口所在的网桥路径成本最低，网桥ID较小，端口ID较小。

- 快速生成树协议：RSTP

   1. rstp端口角色：根端口，指定端口，替代端口，备用端口；
   2. rstp端口状态：丢弃，学习，转发。
rstp快速收敛机制：
   1. 边缘端口机制
   2. 根端口快速切换机制
   3. 指定端口快速切换机制

- 多生成树协议：MSTP
基于实例计算出多棵生成树

---
Vlan trunk（vlan中继）指在交换机之间或交换机与路由器之间连接的情况下，在互相连接的端口上配置中继模式，使得属于不同vlan的数据帧都可以通过这条中继链路进行传输。

VTP指vlan中继协议,用于交换机设置vlan。有三种工作模式：
1. 服务模式：可设置vlan信息，服务器自动广播所以vlan信息到其他交换机
2. 客户模式:不能配置vlan信息，只能接受服务器的vlan配置。
3. 透明模式：可以配置vlan信息，但不广播自己的vlan信息，接受服务器vlan配置信息后不使用，而是直接转发给其他交换机。

交换机初始工作在透明模式下，这个模式下有一个默认的vlan，所有的端口都属于这个vlan
VTP修剪的作用是减掉不必要的trunk链路上的广播，以提升整个交换网的性能和带宽

#### 以太网通道

多条链路负载均匀，提高带宽，容错率。
LACP链路聚合控制协议
PAGP端口聚合协议

### 广域网

采用固定53字节来进行帧分割，称为信元。采用统计时分复用TDM技术。使用虚电路的虚通路VPI和虚信道VCI作为链路标识

HDLC:面向比特的高级数据链路控制协议，是思科私有协议
PPP协议：面向字符；


### 接入技术

1. 窄带（N-ISDN）用户利用2B+D数字用户线拨号上网
2. xDSL：
   1. IDSL：数字用户线路，128kbps，对称模式
   3. *ADSL：非对称用户数字线路，采用频分多路复用技术DMT，非对称模式。下行8Mbps，*
   4. VDSL：超高数据速率数字用户线路，非对称模式
3. 局域网接入
4. 电缆调制解调器:利用有线电视电缆
5. FTTX:光纤接入技术


### 无源光网络PON：
ODN光分配网络，没有有源电子设备，避免电磁干扰；下行采用TDM广播方式，上行采用TDMA时分多址接入方式

PON三种类型：
1. APON:以53字节固定长度的ATM信元方式传输
2. EPON：基于以太网的PON技术，可变长度的分组进行
3. GPON： 上下行传输不对称，兼容上面两种；

### ipv4

ipv4使用32位（四字节）地址。
范围：
A类地址：1.0.0.0-127.255.255.255
B类:128.0.0.0-191.255.255.255
C类：192.0.0.0-223.255.255.255
D类（组播）：224.0.0.1-239.255.255.254
E类（保留）：240.0.0.0-255.255.255.255
0.0.0.0-0.255.255.255

ipv4私有地址范围：
A类中：10.0.0.0-10.255.255.255
B类：172.16.0.0-172.31.255.255
C类：192.168.0.0-192.168.255.255

特殊地址：
0.0.0.0:在本网络上的本主机，目的地址不可以使用，源地址可以使用
127.0.0.1:本地环回地址，用于本地测试
255.255.255.255：全网广播地址，源地址不可以使用，目的地址可以；
169.254.0.0/16：本地链接地址段
子网掩码是用来标识两个IP地址是否同属于一个子网。32位长的二进制数值；为1则代表该位是网络位；为0则表示该位是主机位；

单播地址：
组播地址：tcp/ip协议使用的以太网多播地址块范围为224.0.0.0-239.255.255.255；组播地址只能用于目的地址，不能用于源地址
广播地址：

#### 子网划分:可变长子网掩码(VLSM)
无分类编址CIDR记法：如192.168.1.0/26，其网络位是26位，主机位为6位，主机全为0是网络ID,不是有效主机地址；主机位全为1为此网络ID的广播地址；有效主机IP数量为2^m-2;

汇聚地址块120.64.4.0/22的ip地址范围为120.64.4.0/22-120.64.7.255/22其中120.64.6.0/22为汇聚网络ID，120.64.7.255/22为广播地址
#### ip数据报

组成：首部+数据部分；
首部包含32位，版本，源地址，目的地址。。。。。

### 网际控制报文协议ICMP
1. 对ICMP差错报告报文不再发送ICMP差错报告报文
2. 对特殊地址0.0.0.0或127.0.0.0等的数据报不发送ICMP差错报告报文
3. 对具有多播地址的数据报不发送
4. 对第一个分片的数据报片的所有后续数据报片都不发送

### ipv6
优点：
更大的地址空间:128位地址
更灵活的首部格式等

地址表示：16进制
删除一个或多个前导零，零连续部分用双冒号表示，但只能使用一次

ipv6地址类型：
单播：48位全球路由选择器前缀+16位子网标识符+64位接口标识符（mac地址）
多播：组播地址在ipv6包中不能用作源地址。
任播：用来标识一组网络接口，路由器会将目标地址是任播地址的数据包发给距本路由最近的一个网络接口；

ipv6特殊地址
1. 与ipv4兼容地址：0:0:0:0:0:0:w.x.y.z
2. ipv4映射地址：0:0:0:0:0:FFFF:w.x.y.z

ipv6协议过渡方案：双协议栈，隧道技术，网络地址转换技术；

### UDP协议
特点：无连接，尽最大努力交付，面向报文，首部开销小（8字节），支持1对多

首部（源端口2字节，目的端口2字节，长度2字节，校验和2字节）+数据

### TCP
特点：面向连接，每一条连接只有两个端点，可靠交付，全双工通信，面向字节流

首部（20字节，源端口，目的端口，序号，确认后，校验和。。。。）+数据

三次握手，四次断开

流量控制：可变窗口
拥塞和控制：慢开始，拥塞避免，快重传，快恢复

### 传输层端口
ftp：数据20，控制21
tftp:69
http：80
https：
telnet：23
SMTP：25
pop3:110
DNS:53
DHCP：服务端67，客户端68
SNMP：udp协议；轮询161端口,发送请求和应答，陷阱162

### DNS域名系统
实现将域名和ip地址进行映射，提供解析的分布式数据库服务

分类：
主域名服务器（权威域名服务器）
辅助域名服务器（从域名服务器）
转发域名服务器

解析过程：
本地解析，迭代解析，递归解析

### DHCP服务
Dhcpdiscover：客户端ip租用请求
Dhcpoffer:服务端分配ip
Dhcprequest:客户端接受
Dhcpack:服务端确认
Dhcpdecline:客户端发现服务端分配的ip无法使用

### 路由协议

静态路由协议

配置形式：目标网络+对应掩码+下一跳地址（本地出接口）
动态路由协议

1. RIP路由协议：距离矢量路由协议。基于UDP的520端口发送信息；路由协议优先级为100；经过节点最多不能超过15跳；只会学到邻居路由器的信息；每次路由更新最多承载25调路由；解决路由环路的方法:水平分割；毒性反转；触发更新；抑制计时器。路由器更新周期为30s

||RIPv1|RIPv2|
|-|-|-|
|有无路由协议|有|无|
|是否支持VLSM|否|是|
|是否支持认证|否|是|
|更新类型|广播|组网|

2. OSPF路由协议: 链路状态路由器协议；OSPF报文封装在IP层，协议号为89作为标识，优先级为10。OSPF路由器所发的信息是与本路由相邻的所有路由器的链路状态。每个路由器都存在有全网的链路状态信息。通过244.0.0.5与244.0.0.6发送hello报文建立邻居关系 

ospf网络可以划分为多个区域，每个区域被指定了一个32位的区域标识符，可用点分十进制表示，如0.0.0.0。单域ospf网络只有主干区域网络（配置成区域0）。OSPF的区域分为五种：
1.标准区域：可接受任何链路更新信息和路由汇总信息
2.主干区域：其他区域都通过主干区域交换路由信息。主干区域拥有标准区域的所有性质
3.存根区域：不接受本地自治系统以外的路由信息，对自治系统以外的区域的目标采用默认路由0.0.0.0


3. BGP路由协议；边界网关协议。距离矢量路由协议。适用于自治域（AS）间的路由。通过TCP，179端口建立关系；封装在tcp报文中。防环机制：EBGP=>通过AS-Path属性防环；IBGP=>;


- 路由汇聚：选择网络地址相同的位进行汇聚，不同的位划分至主机位，从而实现将多个网段汇聚成一个新的超网网段。
最佳路由匹配原则：查找路由表时应当选择具有最长前缀的路由，网络的前缀越长，其地址块越小。

### 服务质量QOS
用来解决网路延迟和阻塞问题。用于区分流量，保证重要流量及时被转发
1. 尽力而为服务模型：先进先出
2. 综合服务模型：提前申请网络资源
3. 区分服务模型

### 电子邮件服务
客户端：发送STMP-》接收POP3
网页：http-》STMP-》http
pops:电子邮件客户端上的操作不反馈到服务器上
IMAP：能同步到服务器上

MIME:多用途互联网邮件扩展，支持图片，视频，声音

### HTTP协议
HTTP的URL的一般协议：http://主机:端口/路径

1.浏览器分析超链接指向页面的URL.
2.浏览器向dns请求解析网址
3.域名系统dns解析出网址的ip地址
4.浏览器与服务器建立TCP连接
5.浏览器发出取文件命令:GET/xx/index.htm
6.服务器给出响应
7.TCP连接释放
8.浏览器显示页面

### 网络安全

1. 病毒：传染性，潜伏性，破坏性。前缀：win95
2. 网络蠕虫：不需要用户触发，基本模块：目标搜索模块，攻击模块；前缀worm
3. 木马：隐蔽性，木马本身不带有破坏性，服务端位于被攻击的主机上。前缀：Trojan
4. 后门：一般在黑客初次取得控制权后，留下后门便于下次入侵。前缀：Backdoor

### 网络攻击

1. 主动攻击：
   1. 拒绝服务攻击DOS：消耗资源，破坏配置如ping泛洪、缓冲区溢出、
   2. 分布式拒绝服务DDOs：控制一些计算机后，向攻击目标统一发起拒绝服务攻击（SYNFlooding)
   3. ping of Death攻击：通过ping发送的ICMP的echo请求消息
2. 被动攻击：收集信息而不进行访问：嗅探、信息收集、端口扫描

### 网络安全设备

1. 防火墙： 具有访问控制功能，内容控制功能；对内部网络的攻击无能为力。
2. IDS入侵检测系统：积极主动的安全防护工具，只能发出警告
3. IPS入侵防护系统：提供实时的防护，自动拦截

SNMPv3把对网络协议的安全威胁分为主要和次要两类：
主要：
修改信息，
假冒
修改报文流
消息泄露
次要：
拒绝服务
通信分析。
pgp不是一种完全的非对称加密体系，它是由一个对称加密算法IDEA,一个非对称加密算法RSA，一个单向散列算法MD5组成的混合加密算法。

采取pcm编码,信道的数据速率为`采样率*每次采样所占位数`



netstart -r命令：显示路由记录
Nslookup:用于查询internet域名信息或诊断dns服务器问题的工具
Tracert：跟踪路由
route print；查看路由表命令
